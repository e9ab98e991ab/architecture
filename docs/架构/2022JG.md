## 第1章 绪论

### 1.1 系统架构概述

>系统架构设计师是承担系统架构设计的核心角色，他不仅是连接用户需求和系统进一步设计与实现的桥梁，也是系统开发 早期阶段质量保证的关键角色。随着系统规模和复杂性的提升，系统架构设计师在整个项目研
制中的主导地位愈加重要。可以说，系统架构师就是项目的总设计师，他是一个既需要掌控整体又需要洞悉局部瓶颈，并依据具体的业务场景给出解决方案的总体设计人员：他要确认和评
估系统需求，给出开发规范，搭建系统实现的核心构架，并澄清技术细节、扫清主要难点的技术人员：他要掌握技术团队的能力需要，给出项目管理方法，采用合适生命周期模型，具备以
自身为核心形成团队的能力，并在项目进度计划和经费分配等方面开展评估，以预防项目风险。

系统架构(System Architecture)是系统的一种整体的高层次的结构表示， 是系统的骨架和根基，也决定了系统的健壮性和生命周期的长短。
### 1.1.1 系统架构的定义及发展历程

#### 1.系统架构的定义

**架构**是体现在组件中的一个系统的基本组织、它们彼此的关系与环境的关系及指导它的设 计和发展的原则。
**系统**是组织起来完成某一特定功能或一组功能的组件集。
> 系统这个术语包括了单独的应用程序、传统意义上的系统、子系统、系统之系统、产品线、整个企业及感兴趣的其他集合。系 统用于完成其环境中的一个或多个任务。

**环境**或者上下文决定了对这个系统的开发、运作、政策以及会对系统造成其他影响的环境和设置。
**任务**是由一个或者多个利益相关者通过系统达到一些目标的系统的一个用途或操作。

架构设计的**作用**主要包括以下几点：
* 解决相对复杂的需求分析问题：
* 解决非功能属性在系统占据重要位置的设计问题：
* 解决生命周期长、扩展性需求高的系统整体结构问题：
* 解决系统基于组件需要的集成问题：
* 解决业务流程再造难的问题。

#### 2. 发展历程

软件架构运用而生的条件：

(1)软件复杂、易变，其行为特征难以预见，软件开发过程中需求和设计之间缺乏有效的转换，导致软件开发过程困难和不可控。
(2)随着软件系统的规模越来越大、越来越复杂，整个系统的结构和规格说明就显得越来越重要。
(3)对于大规模的复杂软件系统，相较于对计算算法和数据结构的选择，系统的整体结构设计和规格说明已经变得明显重要得多。
(4)对软件系统结构的深入研究将会成为提高软件生产率和解决软件维护问题的最有希望的新途径。

##### 软件架构的四个发展阶段：

1)基础研究阶段(1968一1994年)

**模块化开发方法**是指把一个待开发的软件分解成若干个小的而且简单的部分，采用对复杂事物分而治之的经典原则。

模块化开发方法涉及的主要问题是模块设计的规则，即系统如何分解成模块。

而每一模块都可独立开发与测试，最后再组装成一个完整软件。

对一个规约进行分解，以得到模块系统结构的方法有数据结构设计法、功能分解法、数据流设计和面向对象的设计等。

#####  将系统分解成模块时，应该遵循以下规则：
(1)最高模块内聚。也就是在一个模块内部的元素最大限度地关联，只实现一种功能的模块是高内聚的，具有三种以上功能的模块则是低内聚的。
(2)最低耦合。也就是不同模块之间的关系尽可能弱，以利于软件的升级和扩展。
(3)模块大小适度。颗粒过大会造成模块内部维护困难，而颗粒过小又会导致模块间的耦合增加。
(4)模块调用链的深度（嵌套层次）不可过多。
(5)接口简单、精炼（扇入扇出数不宜太大），具有信息隐蔽能力。
(6)尽可能地复用已有模块。

#####  基于模块化思想，业界提出了面向对象服务架构(Service-Oriented Architecture,SOA)思想

它提供一组基于标准的方法和技术，通过有效整合和重用现有的应用系统和各种资源实现服务组件化，并基于服务组件实现各种新业务应用的快速组装，帮助企业更好地应对业务的灵活性要求。

这样，通过有效平衡业务的灵活性和IT的复杂度，为开发者提供了新的视角，有效拉近了IT和业务的距离。到20世纪90年代末期，计算机的发展推动了企业管理自动化的步伐，管理信息系统(Management Information System,MIS)在企业中得到了广泛使用。

与此同时，IT业为了降低开发成本，解决业务需求的易变性，实现软件模块的重用，考虑将企业业务与数据处理相分离的分层思想，这也是软件架构的初步雏形。
如下图：

![image-20230208下午22159836](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230208%E4%B8%8B%E5%8D%8822159836.png)

2)概念体系和核心技术形成阶段(1999一2000年)

组件具有可组装性和可插拔性。

每个组件的运行仅依赖于平台或者容器，组件与组件之间不存在直接的耦合关系。同时，组件和组件之间又并非绝对独立。

组件经过组装后可以与其他组件进行业务上的交互。组件化开发并不等同于模块化开发。模块化开发只是在逻辑上做了切分，物理上（代码）通常并没有真正意义上的隔离。

组件化也不等同于应用集成，应用集成是将一些基于不同平台或不同方案的应用软件有机地集成到一个无缝的、并列的、易于访问的单一系统中，以建立一个统一的综合应用。

**组件化比模块化更独立，但比应用集成结合得更加紧密。**

3)理论体系完善与发展阶段(1996年至今)

(1)软件架构描述与表示。
目前存在多种软件架构描述语言，比较典型的是基于组件和消息的软件架构描述语言C2SADL,分布、并发类型的架构描述语言Wright，架构互换语言ACME，基于组件和连接的架构描述语言UniCon，基于事件的架构描述语言Rapide，以及其他比较有影响力的描述语言Darwin、MetaH、Aesop、Weaves、SADL、xADL等。

(2)软件架构分析、设计和测试。
**架构分析**的内容可分为结构分析、功能分析和非功能分析。

分析的目的是系统被实际构造之前预测其质量属性。
架构分析常用的方法有：

软件架构分析方法SAAM、架构权衡分析法ATAM、成本效益分析法CBAM、基于场景的架构再工程SBAR、架构层次的软件可维护性预测ALPSM、软件架构评估模型SAEM等。

**架构设计**是指生成一个满足用户需求的软件架构过程。

架构设计常用的方法有：

从工件描述中提取架构描述的工件驱动(artifact--driven)方法；

从用例导出架构抽象的用例驱动(use-case-driven):

从模式导出架构抽象的模式驱动(pattern-driven)方法；

从领域模型导出架构抽象的域驱动(domain-driven)方法以及从设计过程中获得架构质量属性需求的属性驱动设计(attribute-driven design)方法等。
**架构测试**着重于仿真系统模型、解决架构层的主要问题。

由于测试的抽象层次不同，架构测试策略分为单元、子系统、集成和验收测试等阶段的测试策略。测试方法主要包括架构测试覆盖方法、组件设计正确性验证方法和基于CHAM的架构动态语义验证方法等。

(3)软件架构发现、演化与重用。

**软件架构发现**解决如何从已经存在的系统中提取软件架构的问题，属于逆向工程。

Waters等人提出了一种迭代式架构发现过程。
**软件架构演化**即由于系统需求、技术、环境和分布等因素的变化而最终导致软件架构的变动。软件系统在运行时刻的架构变化称为架构动态性，而将架构的静态修改称为架构扩展。架构扩展和动态性都是架构适应性和演化的研究范畴。
**软件架构复用属于设计重用**，比代码重用更抽象。架构模式就是架构复用的一种成果。

(4)基于软件架构的开发方法。
软件开发模型是跨越整个软件生存周期的系统开发、运行和维护所实施的全部工作和任务的结构框架，给出了软件开发活动各个阶段之间的关系。

通常软件开发模型可分为三种：

以软件需求完全确认为前提的瀑布模型：

在软件开发初期只能提供基本需求为前提的渐进式开发模型（如螺旋模型等）：

以形式化开发方法为基础的变换模型。

(5)软件架构风格。
**架构风格（架构模式）**是针对给定场景中经常出现的问题提供的一般性可重用方案，它反映了领域中众多系统所共有的结构和语义特征，并指导如何将各个模块和子系统有效地组成一个完整的系统。

通常，将软件架构风格分成主要五类(David Garland和Mary Shaw划分方式)：
**数据流风格、调用/返回风格、独立组件风格、虚拟机风格和仓库风格**。

4)普及应用阶段（2000年至今)

>在软件架构的发展历程中，**1999年是一个关键年份**。
>
>这一年召开了第一届FP软件架构会议，并成立了IFIP工作组2.0与全球软件架构师协会。
>
>许多企业开始将软件架构相关理论投入实践，为了使架构描述能够在实践中得到更广泛的应用，Open Group提出了ADML,它是一种基于XML的架构描述语言，支持广泛的架构模型共享。
>
>由于企业对重用以及产品族的形成有着更多考虑，因此，软件产品线成为软件架构的一个重要分支，吸引了大量大型企业的关注。
>软件产品线架构表示一组具有公共的系统需求集的软件系统，它们都是根据基本的用户需求对
>标准的产品线架构进行定制，将可重用组件与系统独立的部分集成而得到的。

软件架构是软件生命周期中的重要产物，它影响软件开发的各个阶段：

* **需求阶段：**把软件架构有的概念引入需求分析阶段，有助于保证需求规约和系统设计之
  间的可追踪性和一致性。
* **设计阶段：**设计阶段是软件架构研究关注最早、最多的阶段，这一阶段的软件架构主要
  包括软件架构的描述、软件架构模型的设计与分析以及对软件架构设计经验的总结与复
  用等。
* **实现阶段：**将设计阶段设计的算法及数据类型用程序设计语言进行表示，满足设计、架
  构和需求分析的要求，从而得到满足设计需求的目标系统。
* 维护阶段：为了保证软件具有良好的维护性，在软件架构中针对维护性目标进行分析
  时，需要对一些有关维护性的属性（如可扩展性、可替换性）进行规定，当架构经过
  定的开发过程实现和形成软件系统时，这些属性也相应地反映了软件的维护性。

纵观软件架构的发展历程，其完成了由实践上升到理论，再由理论反馈指导实践的过程，
理论与实践均处于健康发展中，己经形成良性发展循环。
架构设计师也是随着架构概念的不断演化而逐步发展为软件开发过程中一个非常重要的
角色。

### 1.1.2 软件架构的常用分类及建模方法
#### 1.软件架构的常用分类

多年来，“架构”概念经过不断演化，目前已形成了满足不同用途的架构模式，比较典型的架构模型包括**分层架构、事件驱动架构、微核架构、微服务架构和云架构**等五类。

当然，像**C/S、B/S、管道-过滤器和PAC等架构**也是被广泛使用的软件架构，本节简要说明典型架构内涵。

##### 1)分层架构

分层架构(Layered Architecture)是最常见的软件架构，也是事实上的标准架构。这种架构将软件分成若干个水平层，每一层都有清晰的角色和分工，不需要知道其他层的细节。

层与层之间通过**接口**进行通信。分层架构通常明确约定软件一定要分成多少层。

最常见的是四层结构，

* 表现层(Presentation Layer):用户界面，负责视觉和用户互动：
* 业务层(Business Layer):实现业务逻辑；
* 持久层(Persistence Layer):提供数据，SQL语句就放在这一层；
* 数据库(Database Layer).:保存数据。

![image-20230208下午25258152](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230208%E4%B8%8B%E5%8D%8825258152.png)

有的项目在逻辑层和持久层之间加了一个服务层(Service)，提供不同业务逻辑需要的一些通用接口。用户的请求将依次通过这四层的处理，不能跳过其中任何一层。

##### 2)事件驱动架构
事件(Event)是状态发生变化时软件发出的通知。事件驱动架构(Event-driven Architecture)
是通过事件进行通信的软件架构，它分成四个部分：

* 事件队列(Event Queue)：接收事件的入口：
* 分发器(Event Mediator):将不同的事件分发到不同的业务逻辑单元：
* 事件通道(Event Channel).：分发器与处理器之间的联系渠道；
* 事件处理器(Event Processor):实现业务逻辑，处理完成后会发出事件，触发下一步
  操作。

![image-20230208下午30521640](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230208%E4%B8%8B%E5%8D%8830521640.png)

对于简单的项目，事件队列、分发器和事件通道可以合为一体，整个软件就分成事件代理
和事件处理器两部分。

##### 3)微核架构

**微核架构**(Microkernel Architecture)又称为**插件架构**(Plug-in Architecture)，是指软件的内核相对较小，主要功能和业务逻辑都通过插件实现：

![image-20230208下午33242154](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230208%E4%B8%8B%E5%8D%8833242154.png)

**内核(Coe)**通常只包含系统运行的最小功能。

插件则是互相独立的，插件之间的通信应该减少到最低，避免出现互相依赖的问题。

##### 4)微服务架构
微服务架构(Microservices Architecture)是服务导向架构(Service-Oriented Architecture,SOA)
的升级。

每一个服务就是一个独立的部署单元(Separately Deployed Unit)。

这些单元都是分布式的，互相解耦，通过远程通信协议（比如REST、SOAP)联系：

![image-20230208下午33453804](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230208%E4%B8%8B%E5%8D%8833453804.png)

微服务架构分成三种实现模式。

* **RESTful API模式：**服务通过API提供，云服务就属于这一类；
* **RESTful应用模式：**服务通过传统的网络协议或者应用协议提供，背后通常是一个多功能的应用程序，常见于企业内部：
* **集中消息模式：**采用消息代理(Message Broker)可以实现消息队列、负载均衡、统一日志和异常处理，缺点是会出现单点失败，消息代理可能要做成集群。

##### 5)云架构
云架构(Cloud Architecture)主要解决**扩展性**和**并发**的问题，是**最容易扩展的架构。**
它的高扩展性体现在将数据都复制到内存中，变成可复制的内存数据单元，然后将业务处理能力封装成一个个处理单元(Processing Unit)。

若访问量增加，就新建处理单元；若访问量减少，就关闭处理单元。由于没有中央数据库，所以扩展性的最大瓶颈消失了。

由于每个处理单元的数据都在内存里，需要进行数据持久化。
云架构主要分成两部分：**处理单元**(Processing Unit)和**虚拟中间件**(Virtualized Middleware),
如图所示。

![image-20230209上午104130405](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230209%E4%B8%8A%E5%8D%88104130405.png)

(1)**处理单元**：实现业务逻辑。
(2)**虚拟中间件**：负责通信、保持会话控制(sessions)、数据复制、分布式处理和处理单
元的部署。
这里，虚拟中间件又包含四个组件：

* **消息中间件(Messaging Grid)**:管理用户请求和会话控制(sessions),当一个请求进来以后，它决定分配给哪一个处理单元。
* **数据中间件(Data Grid)**：将数据复制到每一个处理单元，即数据同步。保证某个处理
  单元都得到同样的数据。
* **处理中间件(Processing Grid)：**可选，如果一个请求涉及不同类型的处理单元，该中
  间件负责协调处理单元。
* **部署中间件(Deployment Manager)：**负责处理单元的启动和关闭，监控负载和响应时
  间，当负载增加，就新启动处理单元，负载减少，就关闭处理单元。

#### 2.系统架构的常用建模方法
架构师在进行软件架构设计时，必须掌握软件架构的表示方法，即如何对软件架构建模。
根据建模的侧重点的不同，可以将软件架构的模型分成4种：**结构模型**、**框架模型**、**动态模型**
和**过程模型**。

* **结构模型**：这是一个最直观、最普遍的建模方法。此方法以架构的构件、连接件和其他概念来刻画结构。并力图通过结构来反映系统的重要语义内容，包括**系统的配置、约束、隐含的假设条件、风格和性质**。研究结构模型的核心是架构描述语言。
* **框架模型**：框架模型与结构模型类似，但它不太侧重描述结构的细节，而更侧重整体的结构。框架模型主要以**一些特殊的问题为目标建立只针对和适应问题的结构**。
* **动态模型**：动态模型是对结构或框架模型的补充，主要研究系统的“大颗粒”行为的性质。例如，描述系统的重新配置或演化。这里的动态可以是指系统总体结构的配置、建立或拆除通信或计算的过程，这类系统模型常是激励型的。
* **过程模型**：过程模型是研究构造系统的步骤和过程，其结构是遵循某些过程脚本的结果。
  上述介绍的4种模型并不是完全独立的，通过有机的结合才可形成一个完整的模型来刻画软件架构，也将能更加准确、全面地反映软件架构。

软件架构可从不同角度来描述用户所关心架构的特征。

Philippe Kruchten在1995年提出了一个**“4+1”视角模型**。“4+1”模型从5个不同的视角包括**逻辑(Logical)视角、过程(Process)视角、物理(Physical)视角、开发(Development).视角和场景(Scenarios).视角**来描述软件架构。

每一个视角只关心系统的一个侧面，5个视角结合在一起才能够反映系统的软件架构的全部内容。

#### 1.1.3软件架构的应用场景
软件架构发展至今，已随着信息技术的广泛应用而成为各个领域的关键技术能力。概括来讲，软件架构风格在实践中已被反复使用，不同的架构风格具有各自的优缺点和应用场景，比如：

**管道-过滤器风格**适用于将系统分成若干独立的步骤；

**主程序/子系统和面向对象的架构**风格可用于对组件内部进行设计：

**虚拟机风格**经常用于构造解释器或专家系统：

**C/S和B/S风格**适合于数据和处理分布在一定范围，通过网络连接构成系统：

**平台/插件风格**适用于具有插件扩展功能的应用程序：

**MVC风格**被广泛地应用于用户交互程序的设计：

**SOA风格**应用在企业集成等方面：

**C2风格**适用于GUI软件开发，用以构建灵活和可扩展的应用系统等。
而对于现代大型软件，很少使用单一的架构风格进行设计与开发，而是混合多种风格，从不同视角描述大型软件系统的能力，并可保证软件系统的可靠性、可扩展性、可维护性等非功能属性的正确描述。

#### 1.1.4软件架构的发展未来
从20世纪40年代出现编程算法算起，软件架构及相关技术经历了70余年的发展，其中关键的技术如图1-7所示。

架构发展的主线可以归纳为**模块化编程/面向对象编程、构件技术、面向服务开发技术和云技术**。这些阶段一方面引起了软件开发方法的演变，另一方面引发了领域工程相关技术的广泛应用。

针对架构本身的**描述，建模和验证技术**也在其中扮演着至关重要的角色。
从软件架构的发展历程可知，任何新技术、新方向和新思想的出现都会融入软件架构的发展历程中，如微服务架构、数据驱动架构以及智能架构等。

随着人类认识能力的增强，在不远的将来，一定会出现更具价值的新型软件架构来指引相应的软件开发工作。

![image-20230209上午113954778](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230209%E4%B8%8A%E5%8D%88113954778.png)

#### 1.2 系统架构设计师概述

系统架构设计师(System Architecture Designer.)是项目开发活动中的众多角色之一，它可
以是一个人或一个小组，也可以是一个团队。

架构师(Architect)包含建筑师、设计师、创造者、缔造者等含义，可以说，架构师是社会各领域的创造者和缔造者。
从组织上划分，架构师通常可分为：

业务架构师(Business Architect)、主题领域架构师(Domain Architect)、技术架构师(Technology Architect).、项目架构师(Project Architect)和**系统架构师**(System Architecture)等5类。

如果参考微软公司对架构设计师的分类，这里根据架构师关注的领域不同，可将系统架构设计师分为4种：

企业架构师EA(Enterprise Architect)、基础结构架构师IA(Infrastructure Architect)、特定技术架构师TSA(Technology Architect)和解决方案架构师SA(Solution Architect)。

本书的培养对象重点是围绕系统架构师的职责展开。

#### 1.2.1 架构设计师的定义、职责和任务
##### 1.架构设计师的定义

在定义架构设计师之前，先了解一下架构设计师、架构设计与架构之间的关系，

如图所示：
![image-20230209上午115143628](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230209%E4%B8%8A%E5%8D%88115143628.png)

架构设计师是系统开发的主体角色，他们通过执行一系列活动来实施架构设计。架构设计通过生成过程形成最终的产品架构，架构设计师的成果是创建架构。从图可以看出，系统开发中架构设计师是整个系统的核心。
架构设计师是负责系统架构的人、团队或组织(IEEE 1471-2000)。架构设计师是系统或产品线的设计责任人，是一个负责理解和管理并最终确认和评估非功能性系统需求（如软件的可维护性、性能、复用性、可靠性、有效性和可测试性等)，
给出开发规范，搭建系统实现的核心构架，对整个软件架构、关键构件和接口进行总体设计并澄清关键技术细节的高级技术人员。

##### 2.架构设计师的职责
架构设计师的职责应该是技术领导，这意味着架构设计师除了拥有专门技能外，还必须拥
有领导能力。

首先，领导能力既体现在组织中的职位上，也体现在架构设计师展现的品质上。
**在组织中的职位方面**，架构设计师是项目中的技术领导，应该拥有进行技术决策的权威。项目
经理更关注管理资源、进度和成本方面的项目计划，架构设计师和项目经理代表了这个项目的
公共角色。

**在架构设计师展现的品质方面**，领导力也可以在与其他团队成员的交流中展现出来，架构设计师应该为他人树立榜样并在制定方向方面表现出自信。成功的架构设计师是以人为导向的，都应在指导并培养他们团队的成员上花时间，以保证团队成员能够在后续项目的开发中能够完整地理解架构设计师的设计思路。

其次，拥有专门技能主要体现在除了必须非常清楚项目的总体目标和实施方法外，还应是特定的开发平台、语言、工具的大师，对常见应用场景能及时给出最恰当的解决方案，同时要对所属的开发团队有足够的了解，能够评估该开发团队实现特定的功能需求目标的资源代价。

架构设计师必须非常关注交付的实际结果，并必须赋予项目在技术方面的驱动力，还必须能够进行决策并确保这些决策被传达、理解并始终被执行。

##### 3.架构设计师的任务与组成
架构设计师在项目中的主要任务可概述如下。
(1)领导与协调整个项目中的技术活动（分析、设计和实施等）。
(2)推动主要的技术决策并最终表达为系统架构。
(3)确定系统架构，并促使其架构设计的文档化，这里的文档化应包括需求、设计、实施和部署等“视图”。
从技术角度看，架构设计师的职责就是**抽象设计、非功能设计和关键技术**设计等三大任务。
架构设计师角色可以由一个人或一个团队来履行。在角色和人之间是存在差异的，如一个人可能会履行多个角色。

由于架构设计师需要非常广泛的技能，所以**架构设计师角色通常由多个人履行**。这种方式允许技能分布于多个人，每个人都能充分运用他自己的经验。特别是在理解业务领域和掌握各个方面技术所必须的技能上，往往由几个人才能很好地覆盖。
这个团队是拥有共同目标和执行目标，拥有使他们可以相互负责的方法，同时技能相互补
充的一小部分人。
如果架构设计师角色由一个团队履行，拥有一个首席架构设计师角色非常重要，他不仅具有先知先明的能力、还是架构团队的单点协调人。没有这个协调人，架构团队的成员要创造出内聚的架构或做出决策是困难的。
优秀的架构设计师应知道他的优势和弱势。无论架构设计师的角色是否由一个团队来履行，架构设计师都应有好几个可信顾问的支持，这样架构设计师不仅可以了解其弱点，还可以通过获取必要的技能或与他人一起合作来弥补其知识的缺陷，进而弥补这些弱点。最优秀的架构通常由一个团队而不是个人创建，这仅仅因为当有多人参与进来时，使见识更广和更深。

#### 1.2.2 架构设计师应具备的专业素质

> 架构设计师作为项目的技术领导，他应熟悉业务领域知识并熟练掌握软件开发知识。一个优秀的架构设计师通常可以做到在软件开发知识和业务领域知识之间的平衡。因此，架构设计师应该具备以下专业知识。

1. 掌握业务领域的知识

**领域**是从事于某一行业的人理解并归纳的一组概念和术语知识或者活动范畴(UML,Usr guide 1999).
当架构设计师理解软件开发但不理解业务模型时，可能会开发出一个不能满足用户需求而只能反映该架构设计师所熟悉内容的解决方案，因此，熟悉业务也使得架构设计师能够预见可能发生的改变。

由于架构受其部署环境（包括业务领域）影响很大，对业务领域的正确认识可使架构设计师能够在可能改变的区域和稳定性方面做出更全面的决策。

2. 掌握技术知识

由于架构设计的某些方面明确需要技术知识，所以一个架构设计师应该拥有一定程度的技术水平。然而架构设计师不必是一个技术专家，它必须关注技术的重要因素，而不是细节。架构设计师需要理解像Java EE或.NET这类平台上的可用关键框架，但是不必理解访问这些平台可用的每个应用程序接口(API)的细节。由于技术的发展相当快速，架构设计师必须跟得上这些技术的发展。

3. 掌握设计技能

设计过程是架构设计的核心内容，架构是关键设计决策的具体化，因此，架构设计师应该拥有很强的设计技能。**关键设计决策**指**关键结构设计决策、特定模型的选择和指导规格说明书**等。
为了保证系统的结构完整性，这些元素被代表性的广泛应用并对系统取得成功产生深远的影响。因此，这样的元素应该由拥有相当技能的人识别出来。

设计能力不可能在短时间内获得，而是多年经验积累的结果，因此，一个优秀的架势设计师是要经过多年工作实践才能成为技术领导。

4. 具备编程技能

项目中的**开发人员**是架构设计师必须与之打交道的最重要的团队成员，而项目的最终产品是可执行代码，只有架构设计师承认开发人员的工作价值时，在架构设计师和开发人员之间的沟通才是有效的，尤其是在项目开发后期的缺陷更改时，双方的沟通尤为重要。因此，架构设计师应该具有一定的编程技能，即使他们在项目中不必编写代码，也必须跟上技术的更新。

优秀的架构设计师通常会有组织地参与开发并应该编写一定量的代码，如果架构设计师参与代码
实现，开发组织会从架构设计师那儿获得见识，这些见识可以直接有益于架构的专业知识本身。
架构设计师还可以通过查看他们决策和设计的第一手结果，对开发流程给出反馈。

5. 具备沟通能力

与架构设计师相关的所有软技能中，沟通最重要。架构设计师应该具备有效的口头和书面表达能力。有效的沟通可使开发组织能够充分理解架构设计师的思想，同时开发组织也能够及时将架构设计实现中遇到的问题及时反馈给架构设计师。有效的沟通是项目成功的基础。
架构设计师能够有效地与利益相关方沟通，对于理解他们的需求及与他们就架构达成并保持一致是非常重要的。

**架构设计师不是简单地将信息传达给团队，还要激励团队，架构设计师负责传达系统愿望，以便这个愿望为大家共享，而不是只有架构设计师理解并相信。**

6. 具备决策能力

**决策**是架构设计师必须具备的能力，尤其是在很多不很明确的情况下，而且没有充足的时间研究所有可能性时，架构设计师不能果断决策会延误项目，失去信任。优秀的架构设计师应承认这种情况，即使在决策时咨询其他人并营造共同参与决策的环境，进行适当的决策仍然是架构设计师的职责，而这些决策并不总是正确的，但是架构设计师必须学会纠正这些错误决策。

7. 知道组织策略

成功的架构设计师并不仅仅关心技术，他们还应对政治敏感并知道其在组织中的权利，他们利用这些知识与恰当的人进行沟通，并确保项目在适当的周期中获得支持。

8. 应是谈判专家

架构设计师需要与许多利益相关者进行交流，其中的一些交流需要谈判技巧。架构设计师应特别关注的一点是在项目中尽可能早地把风险降到最低，这对稳定架构所花费的时间有直接影响。

因为风险与需求有关，消除风险的一个途径是通过精炼需求以使这种风险不再出现，因此，必须回退需求以便利益相关者和架构设计师达成一致。这种情形要求架构设计师是一位有效的谈判专家，能够清晰明白地表明各种折中方案的后果。

#### 1.2.3架构设计师的知识结构
架构设计师综合的知识能力结构主要包括10个方面。
(1)战略规划能力。
(2)业务流程建模能力。
(3)信息数据架构能力。
(4)技术架构设计和实现能力。
(5)应用系统架构的解决和实现能力。
(6)基础IT知识及基础设施、资源调配的能力。
(7)信息安全技术支持与管理保障能力。
(8)IT审计、治理与基本需求的分析和获取能力。
(9)面向软件系统可靠性与系统生命周期的质量保障服务能力。
(10)对新技术与新概念的理解、掌握和分析能力。
系统架构设计师必须是开发团队的技术引导者。他们应具有很强的系统思维能力，在项目中需要能够从大量互相冲突的系统方法和工具中，判断出哪些是有效的或者是无效的，并在关键时刻能够做出科学的决策。这样，就要求架构设计师应当是一个思维敏捷、经验丰富、技术水平高超、受过良好教育的善于学习与沟通且决策能力强的人。他必须广泛了解各种技术并精通一种特定技术，至少了解计算机通用技术以便确定哪种技术最优，或组织团队开展技术评估。
优秀的架构设计师能考虑并评估所有可用来解决问题的总体技术方案。架构设计师需要拥有良
好的书面和口头沟通技巧，一般通过可视化模型和小组讨论进行沟通并指导团队，从而确保开
发人员按照架构建造系统。
因此，系统架构设计师应该是一种综合性特强的人才，其知识维度可以满足多层次、多方面的能力。多层次是指架构设计师应在技术领域的深度上掌握更多的基础知识，即必须在体系结构、计算机软硬件与网络基础知识、系统工程、信息系统、嵌入式系统、软件安全与可靠性等知识层面上受过良好教育并拥有自学习能力：还须在架构设计方法、架构模式、开发流程以及各种模型等方面有丰富的经验，广泛了解各种产品和技术并精通一种特定领域的架构设计方法。多方面是指架构设计师应在业务领域以及管理、商务、财务和法律等方面具备一定背景知识并熟悉相关政策，这与系统架构设计师的多角色特点是紧密相关的。

#### 1.3 如何成为一名好的系统架构设计师
##### 1.3.1 如何衡量一名优秀架构设计师

对于系统架构设计师而言，其优劣无法用统一的标准去衡量，优秀与否实际上是相对的，但是，根据架构设计师的能力可以进行评价。架构设计师是一个充满挑战的职业，需要关注很多维度和术。Pat Kua(原专家 Though Works咨询师)提出：

一个好的架构设计师是技术全面的，并给出了成为一个技术全面的架构设计师必须具备的6个角色特质（见下图)。

![image-20230209下午24907602](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230209%E4%B8%8B%E5%8D%8824907602.png)

1. 作为技术领导者

一名好的软件架构设计师需要明白，作为领导者并不一定要告诉开发人员做什么。相反，好的架构设计师就像一个导师，能够带领开发团队向同一个技术愿景前进。好的架构设计师会借助讲故事、影响力、引导冲突和构建信任等领导技能，将他们的架构愿景变成现实。一个好的领导者，同时也是一个好的架构设计师。他/她会仔细听取每个参与者的意见，通过与团队的互动调整他们的愿景。

2. 作为开发人员

一个架构设计师同时又是一个好的开发人员。通常，做出一个良好的架构选择需要权衡理想的架构状态与软件系统的当前状态。例如，如果一个问题更适合采用关系型数据库来解决，那么将文档数据库引入到系统中的做法是毫无道理的。

一个架构设计师如果不考虑技术选型与问题域之间的匹配度，会很容易受到各种技术的诱惑一这也就是常见的“象牙塔式架构设计师”行为模式。
缓解这种情况的最佳方法是让架构设计师多与开发人员待在一起，花一些时间在代码上。了解系统的构建方式及系统的约束，这将帮助架构设计师在当下环境中做出正确的选择。

3. 聚焦系统

经验丰富的开发人员明白代码只是软件的一部分。为了让代码可运行，他们还需要了解代码在生产环境中运行良好所需的其他重要质量属性。

他们需要考虑部署过程、自动化测试、性能、安全和可支持性等多个方面。开发人员可能以临时的方式来实现这些质量属性，而架构设计师不仅需要专注于了解代码，还要了解并满足不同利益相关者（如支持、安全和运营人员）的需求。一个好的架构设计师需要专注于寻找那些能够满足不同利益相关者需求的解决方案，而不是选择针对某一个参与者的偏好或风格进行优化的工具或方法。

4. 具备企业家思维

所有技术选型都有相关的成本和收益，一个好的架构设计师需要从这两个角度考虑新的技术选型，就如成功的企业家是愿意承担风险的，他不但会寻求快速学习的机会和方法，也要学会做好接受失败的心理准备。架构设计师可以用类似的方式做出技术选型，收集真实世界中有关短期和长期成本的信息，以及他们可能意识到的好处。
这方面一个很好的例子是，架构设计师避免承诺立即使用一个在阅读新文章时看到或在某一会议上听到过的工具。相反，他们试图通过架构调研来了解工具在其环境中的相关性，以收集更多信息。他们对于工具的选择不是基于销售量，而是考虑他们需要什么以及这个工具所提供的价值。他们还会寻找这些工具背后的隐性成本，例如工具的支持情况（如文档化程度、社区使用情况)，工具可能带来的约束或长期来看可能带来的额外风险。

5. 权衡策略思维与战术思维

许多团队由一些独立的开发人员一起构建软件，而每个人都倾向于选择自己最舒适或最有经验的工具和技术。

好的架构设计师会持续关注可能有用的新技术、工具或方法，但不一定立即采用它们。技术采用往往需要长期的考量。架构设计师将在团队和组织层面寻求敏捷度（允许团队快速采取行动)和一致性（保持足够的一致性）之间的良好平衡。建立自己的技术雷达进行练习是用战略思维探索技术的一个有用工具。

6. 良好的沟通

架构设计师需要知道，有效的沟通是建立信任和影响团队以外成员的关键技能。他们知道不同群体使用不同的术语，而使用技术术语的描述语言与业务人员沟通将会变得比较困难。与其谈论模式、工具和编程概念，架构设计师需要使用听众熟悉的术语与之交流，诸如风险回报、成本和收益等。这比单纯使用技术词汇进行沟通来得更好。

架构设计师还需要认识到团队内部沟通与外部沟通同样重要，可以使用图表和小组讨论的方式来建立和完善技术愿景，并进行书面记录（如架构决策日志或Wk等），从而为将来留下可追溯的历史。
总之，做一个技术全面的架构设计师并不容易，因为有很多方面需要关注，而每个方面都有很多作为开发人员经常不会专注并练习的技能。其实最重要的不一定是一个架构设计师的能力，而是他们在每个不同的领域都有足够的专业知识。

**有价值的架构设计师需要在上述6个方面都具备良好的专业知识。**

#### 1.3.2从工程师到系统架构设计师的演化
人们通常把系统架构设计师类比为建筑师，其共同点都是做好顶层设计，充当需求方和实施者的桥梁。

但是系统架构设计师和建筑师存在许多不同，对于建筑师而言，在成为建筑设计师之前，是不会成为建筑工人或工程师的：**而系统架构设计师一定是从工程师成长起来的。**
工程师和架构设计师的本质区别主要体现在技术、组织和个人成长上。
在技术上，架构设计师的首要工作是抽象建模，而比首要工作更重要的是要了解自己所处的业务领域。

只有对业务足够了解，才能更好地抽象和建模，也更能沉淀通用的设计方法论。

另一方面，架构设计师需要了解甚至精通业务领域所涉及的技术领域，譬如对于互联网行业的
架构设计师，小到语言、算法、数据库，大到网络协议、分布式系统、服务器、中间件、DC
等等都需要涉猎。

一句话，架构设计师是技术团队的对外接口人，也应该是外部团队技术问题的终结者。

除广度之外还要有深度，对于关键技术模块的设计，架构设计师需要有技术的权威性。而工程师则属于开发团队成员，主要负责项目的具体实现工作，在架构设计师的指导和帮助下，要熟悉相关业务流程，懂得建模方法，使用已确定的开发方法进行设计、编码和测试等工作，从掌握专用技术知识层面来讲，工程师必须熟练掌握详细的设计方法、编程语言、工具和环境。
架构设计师要成为**业务**和**技术**的桥梁，因此需要精通业务和技术的语言，要锻炼沟通能力，不只是口头沟通能力，也包括用标准化的图表表达设计思路的能力。

架构设计师需要一种学会掌握“中庸之道”的方法。不管是技术的选型，团队的协作、培养和分工，商业诉求和成本控制，产品需求和技术诉求的匹配，很多时候都是在做权衡。

可以说，架构的工作主题就是权衡，这可能也是工程师成长为架构设计师的最大挑战。

工程师经常是完美主义的，程序也总是精准而精确的，但是架构设计师要习惯于不完美和一定条件下的不精确。

工程师主要是追求产品的完美形态，通过自己设计出的漂亮程序以充分展示自我能力，很少考虑团队与协同，开发团队相互间为了提升，往往存在相互竞争。
系统架构设计师一般都具备计算机科学或软件工程的知识，由工程师做起，然后再慢慢成长为架构设计师。

成为系统架构设计师的关键是要培养自己的判断力、执行力和创新力。

**判断力**是能够准确判断系统的复杂度在哪里，能准确地看出系统的脆弱点：

**执行力**是能够使用合适的方案解决复杂度问题：

**创新力**是能够创造新的解决方案解决复杂度问题。

因此，要成为一个系统架构设计师，就需要不断地锻炼自己的内功，这些内功来源于经验、视野和思考。因此，要从工程师成长为架构设计师，应遵循积累经验，拓宽视野和深度思考的原则。

下面说明从工程师到架构设计师的成长过程。

1. 工程师阶段

要从一名技术员（助理工程师）成为一个合格的工程师需要参加相关工作13年时间，其典型特征是“在别人的指导下完成开发”，这里的“别人”主要是“高级工程师”或者“技术专家”。

通常情况下，高级工程师或者技术专家负责需求分析、讨论和方案设计，工程师负责编码实现，高级工程师或者技术专家会指导工程师进行编码实现。

工程师阶段应该是原始的“基础技能积累阶段”，主要积累基础知识，包括编程语言、基本数据结构、开发环境、操作系统、数据库以及相关软件开发流程等。

2. 高级工程师阶段

从工程师成长为高级工程师需要3~5年时间，其典型特征是“独立完成开发”，包括需求分析、方案设计和编码实现，其中需求分析和方案设计已经包含了“判断”和“选择”，只是范围相对来说小一些，更多是在已有架构下进行设计。

高级工程师主要需要“积累方案设计经验”，简单来说就是业务当前用到的相关技术的设计经验。
高级工程师阶段相比工程师阶段有两个典型的差异：

**其一是深度**，如果说工程师是要求知道How,那高级工程师就要求知道Why了。

例如Java的各种数据结构的实现原理，因为只有深入掌握了这些实现原理，才能对其优缺点和使用场景有深刻理解，这样在做具体方案设计的时候才能选择合适的数据结构。

**其二是理论**，理论就是前人总结出来的成熟的设计经验，

例如:

数据库表设计的3个范式、

> 原子性（存储的数据应该具有“不可再分性”）
>
> 唯一性 (消除非主键部分依赖联合主键中的部分字段)（一定要在第一范式已经满足的情况下）
>
> 独立性，消除传递依赖(非主键值不依赖于另一个非主键值)

面向对象的设计模式、

> **创建型模式，**共五种：工厂方法模式、抽象工厂模式、单例模式、建造者模式、原型模式。用于描述“”怎样创建对象“，它的主要特点是”将对象的创建与使用分离“。
> **结构型模式，**共七种：适配器模式、装饰器模式、代理模式、外观模式、桥接模式、组合模式、享元模式。用于描述如何将对象和类组装成较大的结构，并同时保持结构的灵活和高效。
> **行为型模式，**共十一种：策略模式、模板模式、观察者模式、迭代器模式、责任链模式、命令模式、备忘录模式、状态模式、访问者模式、中介者模式、解释器模式。用于描述类或对象之间怎样相互协作共同完成单个对象都无法完成的任务，以及怎样分配职责。

SOLID设计原则、

> SRP：单一职责原则
> OCP：开闭原则
> LSP：里氏替换原则
> ISP：接口隔离原则
> DIP：依赖反转原则

[缓存设计理论（缓存穿透、缓存雪崩和缓存热点)](docs%2F%E6%9E%B6%E6%9E%84%2F%E8%B5%84%E6%96%99%2F%E7%BC%93%E5%AD%98%E8%AE%BE%E8%AE%A1%E7%90%86%E8%AE%BA%EF%BC%88%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E5%92%8C%E7%BC%93%E5%AD%98%E7%83%AD%E7%82%B9%29.md)

3. 技术专家阶段

成长为技术专家需要4~8年时间，其典型的特征是“某个领域的专家”，通俗地讲，只要是这个领域的问题，技术专家都可以解决。

例如：Java开发专家、嵌入式开发专家、操作系统开发专家等。通常情况下，“领域”的范围不能太小，例如我们可以说“Java开发专家”，但不会说“Java多线程专家”或“Java JDBC专家”。

技术专家与高级工程师的一个典型区别就是：
高级工程师主要是在已有的架构框架下完成设计，而技术专家会根据需要修改、扩展和优化架构。从高级工程师成长为技术专家，主要需要“拓展技术宽度”，因为一个“领域”必然会涉及众多的技术面。
需要注意的是，拓展技术宽度并不意味着仅仅只是知道一个技术名词，而是要深入去理解每个技术的原理、优缺点以及应用场景。

4. 系统架构设计师（初级)

成长为初级架构设计师需要5~8年时间，其典型特征就是能够“独立完成一个系统的架构设计”，可以是从0到1设计一个新系统，也可以是将架构从1.0重构到2.0。

初级架构设计师负责的系统复杂度相对来说不高，例如后台管理系统、某个业务下的子系统等。

初级架构设计师和技术专家的典型区别是：初级架构设计师是基于完善的架构设计方法论的指导来进行架构设计，而技术专家更多的是基于经验进行架构设计。

简单来说，即使是同样一个方案，初级架构设计师能够清晰地阐述架构设计的理由和原因，而技术专家可能就是因为自己曾经这样做过或者看到别人这样做过而选择设计方案。但在实践工作中，技术专家和初级架构设计师的区别并不很明显，事实上很多技术专家其实就承担了初级架构设计师的角色，因为在系统复杂度相对不高的情况下，架构设计的难度不高，用不同的备选方案最终都能够较好地完成系统设计。
从技术专家成长为初级架构设计师，最主要的是形成自己的“架构设计方法论”。

形成自己的架构设计方法论的主要手段有：**系统学习架构设计方法论，包括订阅专栏或者阅读书籍等：**
深入研究成熟开源系统的架构设计；结合架构设计方法论，分析和总结自己团队甚至公司的各种系统的架构设计的优缺点，尝试思考架构的重构方案。

5. 系统架构设计师（中级)

成长为中级架构设计师需要8~10年以上时间，其典型特征是“能够完成复杂系统的架构设计”，包含高性能、高可用、可扩展、海量存储等复杂系统，例如设计一个总共100人参与开发的业务系统等。中级架构设计师与初级架构设计师的典型区别在于系统复杂度的不同，中级架构设计师面对的系统复杂度要高于初级架构设计师。

以开源项目为例，初级架构设计师可能引入某个开源项目就可以完成架构设计，而中级架构设计师可能发现其实没有哪个开源项目是合适的，而需要自己开发一个全新的项目，事实上很多开源项目就是这样诞生出来的。从初级架构设计师成长为中级架构设计师，最关键的是“技术深度和技术理论的积累”。

6. 系统架构设计师（高级）

成长为高级架构设计师需要10年以上时间，其典型特征是“创造新的架构模式”，例如：

谷歌的分布式存储架构、分布式计算MapReduce架构和列式存储架构等开创了大数据时代；

在虚拟机很成熟的背景下，Docker创造了容器化的技术潮流。

高级架构设计师与中级架构设计师相比，典型区别在于“创造性”，高级架构设计师能够创造新的架构模式，开创新的技术潮流。
总之，关于如何在专业领域内提升，有个著名的“10000小时定律”，简单来说要成为某个领域顶尖的专业人才，需要10000小时持续不断的练习，例如小提琴、足球、国际象棋、围棋等领域，无一例外都遵循这个定律，而技术人员的成长也基本遵循这个定律。

系统架构设计师的成长其实最关键的还是技术人员对技术的热情以及持续不断地投入，包括学习、实践、思考和总结等。

## 第2章 计算机系统基础知识

### 2.1计算机系统概述

计算机系统(Computer System)是指用于数据管理的计算机硬件、软件及网络组成的系统。

它是按人的要求接收和存储信息，自动进行数据处理和计算，并输出结果信息的机器系统。人们在谈及计算机系统时，一般指由**硬件子系统**和**软件子系统**组成的系统，简称为计算机。

而将连接多个计算机以实现计算机间数据交换能力的网络设备，则称之为计算机网络，简称网络。
计算机系统可划分为硬件（子系统）和软件（子系统)两部分。

硬件由机械、电子元器件、磁介质和光介质等物理实体构成，例如处理器（含运算单元和控制单元)、存储器、输入设备和输出设备等。

软件是一系列按照特定顺序组织的数据和指令，并控制硬件完成指定的功能。

可将计算机软件进一步分为系统软件和应用软件: 

**系统软件**是指支持应用软件的运行，为用户开发应用软件提供平台支撑的软件、

而**应用软件**是指计算机用户利用计算机的软、硬件资源为某一专门的应用目的而开发的软件。

典型的计算机系统组成。如图所示。

![image-20230209下午40105922](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230209%E4%B8%8B%E5%8D%8840105922.png)

**从存在形式**上看，计算机硬件是有形的，而软件是无形的：

**从计算机功能**来看，硬件与软件的界限正在逐渐模糊。在不同的应用场合，基于设计考虑，某些功能可能由硬件实现，也可能由软件实现。比如，较典型的可编程逻辑，它在设计阶段可作为软件对待，但运行中则是以逻辑门的物理形态而存在。

随着科技的发展，计算机系统的组成越来越复杂，多功能设备越来越多。
计算机系统的分类维度很多，也较为复杂，可以从**硬件的结构、性能、规模上划分**，亦可从**软件的构成、特征上划分**，或者从**系统的整体用途、服务对象等**进行分类。

这里结合计算机系统的构成特征、应用领域和用途等描述一种常见分类，如图所示。

![image-20230209下午44538556](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230209%E4%B8%8B%E5%8D%8844538556.png)

由于篇幅限制，在图2-2所示的分类中，各结点的具体内容此处不再一一列举说明。

由于技术的交叉和融合，同一设备可以具有多种特征，可以归属于不同的父分类，如电话手表、具
备通信功能的平板电脑、具备路由功能的电视盒等，故该分类并没有严格的界限，仅能够从主体功能进行大致分类。

### 2.2 计算机硬件
#### 2.2.1 计算机硬件组成

计算机组成结构(Computer Architecture)源于冯·诺依曼计算机结构，该结构成为现代计算机系统发展的基础。

冯·诺依曼计算机结构将计算机硬件划分为5部分，但在现实的硬件构成中，

控制单元和运算单元被集成为一体，封装为通常意义上的处理器（但处理器并不是只有上述两部分)；

输入设备和输出设备则经常被设计者集成为一体，按照传输过程被划分为总线、接口和外部设备。

下面按照处理器、存储器、总线、接口和外部设备进行阐述。

#### 2.2.2 处理器
**处理器(Central Processing Unit,,CPU)**作为计算机系统运算和控制的核心部件，经历了长期演化过程。

在位宽上由4位处理器发展到64位处理器：

在能力构成上从仅具有运算和控制功能发展到集成多级缓存、多种通信总线和接口：

在内核上从单核处理器发展为多核、异构多核和众核处理器等。

处理器的指令集按照其复杂程度可分为**复杂指令集(Complex Instruction Set Computers,**
**CISC)**与**精简指令集(Reduced Instruction Set Computers,RISC)**两类。

**CISC以Intel、.AMD的x86CPU为代表，RISC以ARM和Power为代表。**

随着研究的深入，除了由于历史原因而仍然存在的CISC结构外，RISC已经成为计算机指令集发展的趋势，几乎所有后期出现的指令集均为RISC架构。
典型的处理器系统结构如图2-3所示。

![image-20230209下午45017904](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230209%E4%B8%8B%E5%8D%8845017904.png)

在图2-3中，指令部件通过**MMU-Cache**的存储结构，从内存等存储设备中取得相应的软件代码指令并完成译码和控制操作，控制存取部件从存储设备中取得新的数据，控制寄存器组为运算器准备有关寄存器数据，并准备好结果寄存器，控制整型、浮点、向量等运算部件开展运算。运算部件、寄存器单元、存取部件将执行结果通知完成部件，并在完成部件中完成结果的排队，由完成部件向指令部件反馈执行结果，控制指令的顺序执行、跳转等时序。

随着微电子技术发展，用于专用目的处理器芯片不断涌现，常见的有图形处理器(Graphics Processing Unit,GPU)处理器、信号处理器(Digital Signal Processor,DSP)以及现场可编程逻辑门阵列(Field Programmable Gate Array,FPGA)等。

GPU是一种特殊类型的处理器，具有数百或数千个内核，经过优化可并行运行大量计算，因此近些年在深度学习和机器学习领域得到了广泛应用。DSP专用于实时的数字信号处理，通过采用饱和算法处理溢出问题，通过乘积累加运算提高矩阵运算的效率，以及为傅里叶变换设计专用指令等方法，在各类高速信号采集的设备中得到广泛应用。
随着我国国家政策的日益完善，国产处理器也呈现百花齐放的局面。在市场上占有率和知名度较高的包括龙芯、飞腾、申威、兆芯、国微、国芯、华睿、翔腾微和景嘉微等产品，各自在不同的行业领域中得到应用。

#### 2.2.3 存储器
存储器是利用半导体、磁、光等介质制成用于存储数据的电子设备。

根据存储器的硬件结构可分为SRAM、DRAM、NVRAM、Flash、EPROM、Disk等。

计算机系统中的存储器通常采用分层的体系(Memory Hierarchy)结构，按照与处理器的物理距离可分为4个层次。
**(1)片上缓存：**在处理器核心中直接集成的缓存，一般为SRAM结构，实现数据的快速读取。它容量较小，一般为16kB~512kB,按照不同的设计可能划分为一级或二级。
**(2)片外缓存：**在处理器核心外的缓存，需要经过交换互联开关访问，一般也是由SRAM构成，容量较片上缓存略大，可以为256kB~4MB。按照层级被称为L2 Cache或L3 Cache,或者称为平台Cache(PlatformCache)。
**(3)主存（内存）：**通常采用DRAM结构，以独立的部件/芯片存在，通过总线与处理器连接。

DRAM依赖不断充电维持其中的数据，容量在数百MB至数十GB之间。
**(4)外存：**可以是磁带、磁盘、光盘和各类Flsh等介质器件，这类设备访问速度慢，但容量大，且在掉电后能够保持其数据。

不同的介质类型容量有所不同，如Nor Flash容量一般在MB级别，磁盘容量则在GB和TB级别。

外存能够在掉电后保持数据，但并非所有介质都能够永久性保存数据，每种介质都有一定的年限，如Flash外存的维持数据的年限在10年左右，光盘年限在数年至数十年，磁盘年限在10年以上，磁带年限为30年以上。

#### 2.2.4 总线
**总线(Bus)**是指计算机部件间遵循某一特定协议实现数据交换的形式，即以一种特定格式按照规定的控制逻辑实现部件间的数据传输。
按照总线在计算机中所处的位置划分为**内总线**、**系统总线**和**外部总线**。

**内总线**用于各类芯片内部互连，也可称为片上总线(On-Chip Bus)或片内总线。

**系统总线**是指计算机中CPU、主存、I/O接口的总线，计算机发展为多总线结构后，系统总线的含义有所变化，**狭义的**系统总线仍为CPU与主存、通信桥连接的总线：广义上，还应包含计算机系统内，经由系统总线再次级联的总线，常被称为**局部总线(Local Bus)**。

**外部总线**是计算机板和外部设备之间，或者计算机系统之间互联的总线，**又称为通信总线**。总线之间通过桥(Bridge)实现连接，它是一种特殊的外设，主要实现总线协议间的转换。

总线的性能指标常见的有**总线带宽**、**总线服务**、**质量QoS**、**总线时延**和**总线抖动**等。
目前，计算机总线存在许多种类，常见的有**并行总线**和**串行总线**。

**并行总线**主要包括PCI、PCIe和ATA(IDE)等，**串行总线**主要包括USB、SATA、CAN、RS-232、RS-485、RapidIO和以太网等。

在一些专业领域中还定义了多种类型的总线，比如航空领域的ARNC429、ARINC659、ARINC664和MIL-STD-1553B等：工业控制领域的CAN、IEEE1394、PCI、PCIe和VME等。

#### 2.2.5 接口

**接口**是指同一计算机不同功能层之间的通信规则。

计算机接口有多种，常见的包括显示类接口(HDMI、DVI和DVI等)，音频输入输出类接口(TRS、RCA、XLR等)，网络类接口(RJ45、FC等)，PS/2接口，USB接口，SATA接口，LPT打印接口和RS-232接口等。

此外，像离散量接口与AD转换接口等这类接口一般属于非标准接口，而是随需求而设计。
对于总线而言，一种总线可能存在多种接口，比如，以太网总线可以通过RJ45或同轴电
缆与之连接，PCIe总线则具有多种形态的接口实现连接。

#### 2.2.6 外部设备
外部设备也称为外围设备，是计算机的非必要设备（但各类计算机必然会有一些）。

现代计算机的外部设备类日益丰富，包括所有的输入输出设备以及部分存储设备（即外存）。

常见的外部设备包括键盘、鼠标、显示器、扫描仪、摄像头、麦克风、打印机、光驱、各型网卡和各型存储卡/盘等。

在移动和穿戴设备中，常见的包括加速计、GPS、陀螺仪、感光设备和指纹识别设备等。在工业控制、航空航天和医疗等领域，还存在更多种类的外部设备，例如测温仪、测速仪、轨迹球、各型操作面板、红外FC等感应设备、各种场强测量设备、功率驱动装置、各型机械臂、各型液压装置、油门杆和驾驶杆，等等。
随着人们日益增长的物质需求，还会有更多形态各异、功能多样的外部设备产生。各型外部设备虽然种类多样，但都是通过接口实现与计算机主体的连接，并通过指令、数据实现预期的功能。

### 2.3 计算机软件
早期的**计算机软件**和**计算机程序(Computer Program)**的概念几乎不加区别，后来计算机软件的概念在计算机程序的基础上得到了延伸。

**计算机软件**是**指计算机系统中的程序及其文档，是计算任务的处理对象和处理规则的描述**。任何以计算机为处理工具的任务都是计算任务。处理对象是数据（如数字、文字、图形、图像和声音等，他们只是表示，而无含义）或信息（数据及有关的含义)。

处理规则一般指处理的动作和步骤，文档是为了便于了解程序所需的阐述性资料。

#### 2.3.1 计算机软件概述

**软件系统**是**指在计算机硬件系统上运行的程序、相关的文档资料和数据的集合。**计算机软件用来扩充计算机系统的功能，提高计算机系统的效率。

按照软件所起的作用和需要的运行环境的不同，通常将计算机软件分为**系统软件**和**应用软件**两大类。
**系统软件**是为整个计算机系统配置的不依赖特定应用领域的通用软件。这些软件对计算机系统的硬件和软件资源进行控制和管理，并为用户使用和其他应用软件的运行提供服务。也就是说，只有在系统软件的作用下，计算机硬件才能协调工作，应用软件才能运行。

**根据系统软件功能的不同**，可将其划分为：**操作系统、程序设计语言翻译系统、数据库管理系统和网络软件等。**
**应用软件**是**指为某类应用需要或解决某个特定问题而设计的软件**，如图形图像处理软件、财务软件、游戏软件和各种软件包等。在企事业单位或机构中，应用软件发挥着巨大的作用，承担了许多计算任务，如人事管理、财务管理和图书管理等。按照应用软件使用面的不同，可进一步把应用软件分为**专用的应用软件**和**通用的应用软件**两类。

#### 2.3.2 操作系统
**操作系统**是计算机系统的资源管理者，它包含对系统软、硬件资源实施管理的一组程序，其首要作用就是通过CPU管理、存储管理、设备管理和文件管理对各种资源进行合理地分配，改善资源的共享和利用程度，最大限度地发挥计算机系统的工作效率，提高计算机系统在单位时间内处理工作的能力。

操作系统是配置在计算机硬件上的第1层软件，它向下管理裸机及其中的文件，向上为其他的系统软件（汇编程序、编译程序、数据库管理系统等）和大量应用软件提供支持，以及为用户提供方便使用系统的接口。
1. 操作系统的组成

操作系统是一种大型、复杂的软件产品，它们通常由操作系统内核(Kernel)和其他许多附加的配套软件所组成，包括图形用户界面程序、常用的应用程序（如日历、计算器、资源管理器和网络浏览器等)、实用程序（任务管理器、磁盘清理程序、杀毒软件和防火墙等）以及为支持应用软件开发和运行的各种软件构件（如应用框架、编译器和程序库等）。
操作系统内核指的是能提供进程管理（任务管理）、存储管理、文件管理和设备管理等功能的那些软件模块，它们是操作系统中最基本的部分，用于为众多应用程序访问计算机硬件提供服务。由于应用程序直接对硬件操作非常复杂，所以操作系统内核对硬件设备进行了抽象，为应用软件提供了一套简洁、统一的接口（称为**系统调用接口**或**应用程序接口API)**。内核通常都驻留在内存中，它以CPU的最高优先级运行，能执行指令系统中的特权指令，具有直接访问各种外设和全部主存空间的特权，负责对系统资源进行管理和分配。

2. 操作系统的作用

操作系统主要有以下3个方面的重要作用。
**(1)管理计算机中运行的程序和分配各种软硬件资源**。

计算机中一般总有多个程序在运行，这些程序在运行时都可能要求使用系统中的资源（如访问硬盘，在屏幕上显示信息等），此时操作系统就承担着资源的调度和分配任务，以避免冲突，保证程序正常有序地运行。操作系统的资源管理功能主要包括处理器管理、存储管理、文件管理、I/O设备管理等几个方面。
**(2)为用户提供友善的人机界面。**

人机界面的任务是实现用户与计算机之间的通信（对话)。几乎所有操作系统都向用户提供图形用户界面(GUI),它通过多个窗口分别显示正在运行的各个程序的状态，采用图标(Icon)来形象地表示系统中的文件、程序和设备等对象，用户借助单击“菜单”的方法来选择要求系统执行的命令或输入某个参数，利用鼠标器或触摸屏控制屏幕光标的移动，并通过单击操作以启动某个操作命令的执行，甚至还可以采用拖放方式执行所需要的操作。这些措施使用户能够比较直观、灵活、有效地使用计算机。
**(3)为应用程序的开发和运行提供一个高效率的平台。**安装了操作系统之后，实际上呈现在应用程序和用户面前的是一台“虚拟计算机”。操作系统屏蔽了几乎所有物理设备的技术细节，它以规范、高效的方式（例如系统调用、库函数等）向应用程序提供了有力的支持，从而为开发和运行其他系统软件及各种应用软件提供了一个平台。
除了上述3个方面的作用之外，操作系统还具有辅导用户操作（帮助功能）、处理软硬件错误、监控系统性能、保护系统安全等许多作用。

总之，有了操作系统，计算机才能成为一个高效、可靠、通用的数据处理系统。

3. 操作系统的特征

**1)并发性**
在多道程序环境下，并发性是指在一段时间内，宏观上有多个程序同时运行，但实际上在单CPU的运行环境，每一个时刻只有一个程序在执行。因此，从微观上来说，各个程序是交替、轮流执行的，如果计算机系统中有多个CPU,则可将多个程序分配到不同CPU上实现并行运行。
**2)共享性**
共享是指操作系统中的资源（包括硬件资源和信息资源）可以被多个并发执行的进程（线程)共同使用，而不是被一个进程所独占。出于经济上的考虑，一次性向每个用户程序分别提供它所需的全部资源不但是浪费的，有时也是不可能的。现实的方法是让操作系统和多个用户程序共用一套计算机系统的所有资源，因此必然会产生共享资源的需要。**共享资源的方式**可以分为**同时共享**和**互斥共享**。
**3)虚拟性**
虚拟性是指操作系统中的一种管理技术，它是把物理上的一个实体变成逻辑上的多个对应物，或把物理上的多个实体变成逻辑上的一个对应物的技术。前者是实际存在的，而后者是虚构假想的，是用户感觉上的东西。采用虚拟技术的目的是为用户提供易于使用且方便高效的操作环境。
**4)不确定性**
在多道程序环境中，允许多个进程并发执行，但由于资源有限，在多数情况下进程的执行不是一贯到底的，而是“走走停停”。例如一个进程，在CPU上运行一段时间后，由于等待资源或某事件发生，它被暂停执行，将CPU转让给另一个进程执行。系统中的进程何时执行，何时暂停，以什么样的速度向前推进，进程总共要花多少时间执行才能完成，这些都是不可预知的。或者说该进程是以不确定的方式运行的，其导致的直接后果是程序执行结果可能不唯一。

4. 操作系统的分类

通常，操作系统可分为**批处理操作系统**、分时操作系统、**实时操作系统**、网络操作系统、**分布式操作系统**、**微型计算机操作系统**和嵌入式操作系统等类型。
**1)批处理操作系统**
批处理操作系统分为单道批处理和多道批处理。
单道批处理操作系统是一种早期的操作系统，用户可以向系统提交多个作业，“单道”的含义是指一次只有一个作业装入内存执行。作业由**用户程序、数据和作业说明书（作业控制语言）**3个部分组成。当一个作业运行结束后，随即自动调入同批的下一个作业，从而节省了作业之间的人工干预时间，提高了资源的利用率。
**多道批处理操作系统**允许多个作业装入内存执行，在任意一个时刻，作业都处于开始点和终止点之间。每当运行中的一个作业由于输入/输出操作需要调用外部设备时，就把CPU交给另一个等待运行的作业，从而将主机与外部设备的工作由串行改变为并行，进一步避免了因主机等待外设完成任务而浪费宝贵的CPU时间。

多道批处理系统主要有3个特点：**多道**、**宏观上并行运行**和**微观上串行运行**。
**2)分时操作系统**
在分时操作系统中，一个计算机系统与多个终端设备连接。分时操作系统是将CPU的工作时间划分为许多很短的时间片，轮流为各个终端的用户服务。

例如，一个带20个终端的分时系统，若每个用户每次分配一个50s的时间片，则每隔1s即可为所有的用户服务一遍。因此，尽管各个终端上的作业是断续运行的，但由于操作系统每次对用户程序都能做出及时响应，因此用户感觉整个系统均归其一人占用。
**分时系统主要有4个特点：多路性、独立性、交互性和及时性。**

3)实时操作系统
**实时是指计算机对于外来信息能够以足够快的速度进行处理，并在被控对象允许的时间范围内做出快速反应。**

实时系统对交互能力要求不高，但要求可靠性有保障。
实时系统分为**实时控制系统**和**实时信息处理系统**。

**实时控制系统**主要用于生产过程的自动控制，例如数据自动采集、武器控制、火炮自动控制、飞机自动驾驶和导弹的制导系统等。

**实时信息处理系统**主要用于实时信息处理，例如飞机订票系统、情报检索系统等。
4)网络操作系统
**网络操作系统是使联网计算机能方便而有效地共享网络资源，为网络用户提供各种服务的软件和有关协议的集合。**

因此，网络操作系统的功能主要包括**高效、可靠的网络通信**：

**对网络中共享资源（在LAN中有硬盘、打印机等）的有效管理**：

**提供电子邮件、文件传输、共享硬盘和打印机等服务**：

**网络安全管理**；

**提供互操作能力**。
一个典型的网络操作系统的特征包括**硬件独立性**和**多用户支持**等。其中：

**硬件独立性**是指网络操作系统可以运行在不同的网络硬件上，可以通过网桥或路由器与其他网络连接：

**多用户支持**，应能同时支持多个用户对网络的访问，应对信息资源提供完全的安全和保护功能；

**支持网络实用程序及其管理**功能，如系统备份、安全管理、容错和性能控制：

**多种客户端支持**：提供目录服务，以单一逻辑的方式让用户访问位于世界范围内的所有网络服务和资源的技术：

**支持多种增值服务**，如文件服务、打印服务、通信服务和数据库服务等。

5)分布式操作系统

**分布式计算机系统**是由多个分散的计算机经连接而成的计算机系统，系统中的计算机无主、次之分，任意两台计算机可以通过通信交换信息。通常，为分布式计算机系统配置的操作系统称为分布式操作系统。
分布式操作系统能直接对系统中的各类资源进行动态分配和调度、任务划分、信息传输协调工作，并为用户提供一个统一的界面与标准的接口，用户通过这一界面实现所需要的操作和使用系统资源，使系统中若干台计算机相互协作完成共同的任务，有效地控制和协调诸任务的并行执行。
分布式操作系统是网络操作系统的更高级形式，它保持网络系统所拥有的全部功能，同时**又有透明性、可靠性和高性能**等特性。

6)微型计算机操作系统

微型计算机操作系统简称微机操作系统，常用的有Windows、Mac OS、Linux。

7)嵌入式操作系统

嵌入式操作系统运行在嵌入式智能设备环境中，对整个智能硬件以及它所操作、控制的各种部件装置等资源进行统一协调、处理、指挥和控制，其主要特点如下。

* 微型化：从性能和成本角度考虑，希望占用的资源和系统代码量少，如内存少、字长短、运行速度有限、能源少（用微小型电池）。
* 可定制：从减少成本和缩短研发周期考虑，要求嵌入式操作系统能运行在不同的微处理器平台上，能针对硬件变化进行结构与功能上的配置，以满足不同应用需要。
* 实时性：嵌入式操作系统主要应用于过程控制、数据采集、传输通信、多媒体信息及关键要害领域需要迅速响应的场合，所以对实时性要求较高。
* 可靠性：系统构件、模块和体系结构必须达到应有的可靠性，对关键要害应用还要提供容错和防故障措施。
* 易移植性：为了提高系统的易移植性，通常采用硬件抽象层(Hardware Abstraction Level,HAL)和板级支撑包(Board Support Package,BSP)的底层设计技术。

常见的嵌入式实时操作系统有Vx Works、.μClinux、PalmOS、WindowsCE、μC/OS-II和eCos等。

#### 2.3.3 数据库

在信息处理领域，由于数据量庞大，如何有效组织、存储数据对实现高效率的信息处理至关重要。数据库技术是目前最有效的数据管理技术。

数据库(DataBase,DB)是指长期存储在计算机内、有组织的、统一管理的相关数据的集合。它不仅描述事物的数据本身，而且还包括相关事物之间的联系。数据库可以直观地理解为存放数据的仓库，只不过这个仓库是在计算机的存储设备上，而且数据是按一定格式存放的，具有较小的冗余度、较高的数据独立性和易扩展性，可为多个用户共享。
早期数据库种类有3种，分别是**层次式数据库**、**网络式数据库**和**关系型数据库**。

目前最常见的数据库种类是**关系型数据库**和**非关系型数据库**。

根据数据库存储体系分类，还可分为**关系型数据库**、**键值(Key-Value)数据库**、**列存储数据库**、**文档数据库**和**搜索引擎数据库**等类型。
**(1)关系型数据库**。

这种类型的数据库是最传统的数据库类型，关系型数据库模型是把复杂的数据结构归结为简单的二元关系，在数据库中，对数据的操作几乎全部建立在一个或多个关系表格上。在大型系统中通常有多个表，且表之间有各种关系。实际使用就是通过对这些关联的表格进行分类、合并、连接或选取等运算来实现数据库的管理。

**(2)键值数据库。**

键值数据库是一种非关系型数据库，它使用简单的键值方法来存储数据。键值数据库将数据存储为键值对集合，其中键作为唯一标识符。

**(3)列存储数据库。**

列式存储(Column-Based)是相对于传统关系型数据库的行式存储(Row-Basedstorage)来说的。简单来说两者的区别就是对表中数据的存储形式的差异。

**(4)文档数据库。**

此类数据库可存放并获取文档，可以是XML、JSON、BSON等格式，这些文档具备可述性(Self-Describing),呈现分层的树状结构(Hierarchical Tree Data Structure),可以包含映射表、集合和纯量值。

数据库中的文档彼此相似，但不必完全相同。文档数据库所存放的文档，就相当于键值数据库所存放的“值”。文档数据库可视为其值可查的键值数据库。

**(5)搜索引擎数据库。**

搜索引擎数据库是应用在搜索引擎领域的数据存储形式，由于搜索引擎会爬取大量的数据，并以特定的格式进行存储，这样在检索的时候才能保证性能最优。
下面简要介绍常用的关系数据库和分布式数据库。

1. 关系数据库

数据模型是数据特征的抽象，它是对数据库组织方式的一种模型化表示，是数据库系统的核心与基础。它具有**数据结构、数据操作和完整性约束**条件三要素。
**关系**可以理解为二维表。一个关系模型就是指用若干关系表示实体及其联系，用二维表的形式存储数据。

例如，对某高校学生的选课（不同年级甚至同一年级学生所选课程可以不同）进行管理，可以用二维表表示，如图2-4所示。

![image-20230210下午23124823](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230210%E4%B8%8B%E5%8D%8823124823.png)

用关系表示如下，其中带下画线的属性为主码，主码能唯一确定某个实体，如学号能唯一
确定某个学生。

学生（<u>学号</u>，姓名，年龄，系别）
课程（<u>课程号</u>，课程名，学分）
选课（<u>学号</u>，<u>课程号</u>，分数）

**1)关系数据库设计的特点及方法**

数据库设计是指对于一个给定的应用环境构造最优的数据库，建立数据库及其应用系统，使之能有效地存储数据，满足各种用户的需求。数据库设计包括**结构特性**和**行为特性**的设计两方面的内容。
数据库设计的很多阶段都可以和软件工程的各阶段对应起来。

数据库设计的特点有：

> 从数据结构即数据模型开始，并以数据模型为核心展开，这是数据库设计的一个主要特点；

> 静态结构设计与动态行为设计分离：

> 试探性：反复性和多步性。

目前已有的数据库设计方法可分为4类，即**直观设计法**、**规范设计法**、**计算机辅助设计法**和**自动化设计法**。

常用的有基于**3NF的设计方法**、基于**实体联系(ER)模型的数据库设计方法**、基于**视图概念的数据库设计方法**、**面向对象的关系数据库设计方法**、**计算机辅助数据库设计方法**、**敏捷数据库设计方法**等。

**2)关系数据库设计的基本步骤**
数据库设计分为**需求分析、概念结构设计、逻辑结构设计、物理结构设计、应用程序设计和运行维护6个阶段**，如图2-5所示。

![image-20230210下午24115390](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230210%E4%B8%8B%E5%8D%8824115390.png)

**需求分析阶段**的任务是对现实世界要处理的对象（组织、部门和企业等）进行详细调查，在了解现行系统的概况和确定新系统功能的过程中，收集支持系统目标的基础数据及其处理方法。需求分析是在用户调查的基础上，通过分析逐步明确用户对系统的需求，包括数据需求和围绕这些数据的业务处理需求。
**数据库概念结构设计**是在需求分析的基础上，依照需求分析中的信息需求，对用户信息加以分类、聚集和概括，建立信息模型，并依照选定的数据库管理系统软件，把它们转换为数据的逻辑结构，再依照软硬件环境，最终实现数据的合理存储。这一过程也称为数据建模。
**设计数据库概念模型**的最著名、最常用的方法是ER方法。采用E-R方法的数据库概念结构设计可分为三步：**设计局部E-R模型、设计全局E-R模型以及全局ER模型的优化**。
**逻辑结构设计**是在概念结构设计基础上进行的数据模型设计，可以是**层次**、**网状模型**和**关系模型**。逻辑结构设计阶段的主要任务是确定数据模型，将ER图转换为指定的数据模型，确定完整性约束，确定用户视图。
**数据库在物理设备上的存储结构与存取方法**称为数据库的物理结构。数据库的物理结构设计是对已确定的数据库逻辑结构，利用DBMS(数据库管理系统(Database Management System)所提供的方法、技术，以较优的存储结构和数据存取路径、合理的数据存放位置以及存储分配，设计出一个高效的、可实现的数据库物理结构。
数据库应用系统开发是DBMS的二次开发，**一方面是对用户信息的存储：** **另一方面就是对用户处理要求的实现。**
数据库应用程序设计要做的工作有，**选择设计方法**、**制订开发计划**、**选择系统架构和设计安全性策略**。

在应用程序设计阶段，设计方法有**结构化设计方法**和**面向对象设计方法**两种。

安全性策略主要是指硬件平台、操作系统、数据库系统、网络及应用系统的安全。
数据库的正常运行和优化也是数据库设计的内容之一。

在数据库运行维护阶段要做的工作主要有**数据库的转储和恢复**，**数据库的安全性和完整性控制**，**数据库性能的监督**、**分析和改造**，**数据库的重组和重构**等。

2. 分布式数据库

分布式数据库系统(Distributed DataBase System,DDBS)是针对地理上分散，而管理上又需要不同程度集中管理的需求而提出的一种数据管理信息系统。满足**分布性、逻辑相关性、场地透明性和场地自治性**的数据库系统被称为完全分布式数据库系统。
分布式数据库系统的特点是**数据的集中控制性、数据独立性、数据冗余可控性、场地自治性和存取的有效性。**
**1)分布式数据库体系结构**
我国在多年研究与开发分布式数据库及制定《分布式数据库系统标准》中，提出了把分布式数据库抽象为4层的结构模式，如图2-6所示。这种结构模式得到了国内外一定程度的支持和认同。

![image-20230210下午44334470](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230210%E4%B8%8B%E5%8D%8844334470.png)

4层模式划分为**全局外层、全局概念层、局部概念层和局部内层**，在各层间还有相应的层间映射。这种4层模式适用于同构型分布式数据库系统，也适用于异构型分布式数据库系统。

**2)分布式数据库的应用**

分布式数据库的应用领域有**分布式计算、Internet.应用、数据仓库、数据复制以及全球联网**
**查询等**，Sybase公司的Replication Server即是一种典型的分布式数据库系统。

3. 常用数据库管理系统

计算机科学技术不断发展，数据库管理系统也不断发展进化，MySQL AB公司(2009年被Oracle公司收购)的MySQL、Microsoft公司的Access等是小型关系数据库管理系统的代表，
Oracle公司的Oracle、Microsoft公司的SQL Server、IBM公司的DB2等是功能强大的大型关系数据库管理系统的代表。
**1)Oracle**
Oracle是一种适用于大型、中型和微型计算机的**关系数据库管理系统。**Oracle的结构包括数据库的内部结构、外存储结构、内存储结构和进程结构。在Oracle中，数据库不仅指物理上的数据，还包括处理这些数据的程序，即DBMS本身。Oracle使用PL/SQL(Procedural Language/SQL)语言执行各种操作。Oracle除了以关系格式存储数据外，Oracle8以上的版本还支持面向对象的结构（如抽象数据类型）。
Oracle产品主要包括数据库服务器、开发工具和连接产品三类。Oracle还提供了一系列的工具产品，如逻辑备份工具Export、Import等。
**2)IBM DB2**
DB2是IBM的一种分布式数据库解决方案。简单地说，DB2就是IBM开发的一种大型**关系型数据库**平台，它支持多用户或应用程序在同一条SQL语句中查询不同Database甚至不同DBMS中的数据。
DB2核心数据库的特色有支持面向对象编程，支持多媒体应用程序，支持备份和恢复功能，支持存储过程和触发器，支持SQL查询，支持异构分布式数据库访问，支持数据复制。
DB2采用多进程多线索体系结构，可运行于多种操作系统之上。IBM还提供了Visualizer、
Visualage、Visualgen等开发工具。

**3)Sybase**
Sybase是美国SYBASE公司在20世纪80年代中期推出的**客户机/服务器(Client/Server,C/S)结构的关系**数据库系统，也是世界上第一个真正的基于客户机/服务器结构的RDBMS产品。

Sybase数据库主要由三部分组成：进行数据库管理和维护的联机关系数据库管理系统Sybase SQLServer，支持数据库应用系统建立与开发的一组前端工具Sybase SQLToolset,.可把异构环境下其他厂商的应用软件和任何类型的数据连接在一起的接口Sybase OpenClient/OpenServer Sybase提供了Sybase Adaptive Server Enterprise高性能企业智能型关系数据库管理系统、EAServer电子商务解决方案应用服务器、系统分析设计工具PowerDesigner和应用开发工具PowerBuilder
**4 )Microsoft SQL Server**
Microsoft SQL Server是一种典型的**关系型数据库管理系统**，可运行于多个操作系统上，它使用Transact-SQL语言完成数据操作。

SQL Server的基本服务器组件包括Open Data Services、MS SQL Server、SQL Server Agent
MSDTC (Microsoft Distributed Transaction Coordinator).
SQL Server数据平台包括以下工具：**关系型数据库、复制服务、通知服务、集成服务、分析服务、报表服务、管理工具和开发工具。**

4. 大型数据库管理系统的特点

大型数据库管理系统主要有如下7个特点。
**(1)基于网络环境的数据库管理系统。**

可以用于C/S结构的数据库应用系统，也可以用于B/S结构的数据库应用系统。

**(2)支持大规模的应用。**

可支持数千个并发用户、多达上百万的事务处理和超过数百GB的数据容量。
**(3)提供的自动锁功能使得并发用户可以安全而高效地访问数据。**
**(4)可以保证系统的高度安全性。**
**(5)提供方便而灵活的数据备份和恢复方法及设备镜像功能，还可以利用操作系统提供容错功能，确保设计良好的应用中的数据在发生意外的情况下可以最大限度地被恢复。**
**(6)提供多种维护数据完整性的手段。**
**(7)提供了方便易用的分布式处理功能。**

#### 2.3.4 文件系统
1. 文件与文件系统

文件(Fle)是具有符号名的、在逻辑上具有完整意义的一组相关信息项的集合，

例如，一个源程序、一个目标程序、编译程序、一批待加工的数据和各种文档等都可以各自组成一个文件。

文件是一种抽象机制，它隐藏了硬件和实现细节，提供了将信息保存在外存上而且便于以后读取的手段，使用户不必了解信息存储的方法、位置以及存储设备实际操作方式便可存取信息。

一个**文件**包括**文件体**和**文件说明**。

文件体是文件真实的内容：

文件说明是操作系统为了管理文件所用到的信息，包括文件名、文件内部标识、文件类型、文件存储地址、文件长度、访问权限、建立时间和访问时间等。

**文件系统**是操作系统中实现文件统一管理的一组软件和相关数据的集合，是专门负责管理和存取文件信息的软件机构。

文件系统的功能包括按名存取，即用户可以“按名存取”，而不是“按地址存取”：

**统一的用户接口**，在不同设备上提供同样的接口，方便用户操作和编程；

**并发访问和控制**，在多道程序系统中支持对文件的并发访问和控制：

**安全性控制**，在多用户系统中的不同用户对同一文件可有不同的访问权限：

**优化性能**，采用相关技术提高系统对文件的存储效率、检索和读/写性能：

**差错恢复**，能够验证文件的正确性，并具有一定的差错恢复能力。

2. 文件的类型

(1)按**文件的性质和用途**分类可将文件分为**系统文件、库文件和用户文件**。
(2)按**信息保存期限分类**可将文件分为**临时文件**、**档案文件**和**永久文件**。
(3)按**文件的保护方式分类**可将文件分为**只读文件、读/写文件、可执行文件和不保护文件**。
(4)**UNIX系统将文件**分为**普通文件、目录文件和设备文件（特殊文件）**。

目前常用的文件系统类型有FAT、VFAT、NTFS、Ext2和HPFS等。
**文件分类的目的**是对**不同文件进行管理，提高系统效率，提高用户界面友好性。**

当然，根据文件的存取方法和物理结构的不同，还可以将文件分为不同的类型。

3. 文件的结构和组织

**文件的结构**是指文件的组织形式。

从用户角度看到的文件组织形式称为文件的逻辑结构，文件系统的用户只要知道所需文件的文件名就可以存取文件中的信息，而无须知道这些文件究竟存放在什么地方。

从实现的角度看，文件在文件存储器上的存放方式称为文件的物理结构。

**1)文件的逻辑结构**

文件的逻辑结构可分为两大类：

**一是有结构的记录式文件**，它是由一个以上的记录构成的文件：

**二是无结构的流式文件**，它是由一串顺序字符流构成的文件。

在记录式文件中，所有的记录通常都是描述一个实体集的，有着相同或不同数目的数据项，记录的长度可分为定长（指文件中所有记录的长度相同）和不定长（指文件中各记录的长度不相同)两类。

**无结构的流式文件**的**文件体**为**字节流**，不划分记录。

无结构的流式文件通常采用顺序访问方式，并且每次读/写访问可以指定任意数据长度，其长度以字节为单位。

对于流式文件的访问，是利用读/写指针指出下一个要访问的字符。可以把流式文件看作是记录式文件的一个特例。

**2)文件的物理结构**

**文件的物理结构**是指**文件的内部组织形式**，即文件在物理存储设备上的存放方法。由于文件的物理结构决定了文件在存储设备上的存放位置，所以文件的逻辑块号到物理块号的转换也是由文件的物理结构决定的。

根据用户和系统管理上的需要，可采用多种方法来组织文件，下面介绍几种常见的文件物理结构。

**(1)连续结构。**
连续结构也称顺序结构，它将逻辑上连续的文件信息（如记录）依次存放在连续编号的物理块上。只要知道文件的起始物理块号和文件的长度，就可以很方便地进行文件的存取。

**(2)链接结构。**
链接结构也称串联结构，它是将逻辑上连续的文件信息（如记录）存放在不连续的物理块上，每个物理块设有一个指针指向下一个物理块。因此，只要知道文件的第1个物理块号，就可以按链指针查找整个文件。

**(3)索引结构。**
在采用索引结构时，将逻辑上连续的文件信息（如记录）存放在不连续的物理块中，系统为每个文件建立一张索引表。索引表记录了文件信息所在的逻辑块号对应的物理块号，并将索引表的起始地址放在与文件对应的文件目录项中。

**(4)多个物理块的索引表。**
索引表是在文件创建时由系统自动建立的，并与文件一起存放在同一文件卷上。根据一个文件大小的不同，其索引表占用物理块的个数不等，一般占一个或几个物理块。多个物理块的索引表可以有两种组织方式：**链接文件**和**多重索引方式**。

4. 文件存取的方法和存储空间的管理

**1)文件的存取方法**
文件的存取方法是指读/写文件存储器上的一个物理块的方法。通常有**顺序存取**和**随机存取**两种方法。

**顺序存取方法**是指对文件中的信息按顺序依次进行读/写：

**随机存取方法**是指对文件中的信息可以按任意的次序随机地读/写。

**2)文件存储空间的管理**

要将文件保存到外部存储器（简称外存或辅存）上，首先必须知道存储空间的使用情况，即哪些物理块是被“占用”的，哪些是“空闲”的。特别是对大容量的磁盘存储空间被多用户共享时，用户执行程序经常要在磁盘上存储文件和删除文件，因此，文件系统必须对磁盘空间进行管理。

**外存空闲空间管理的数据结构通常称为磁盘分配表(Disk Allocation Table)**。常用的空闲空间管理方法**有空闲区表、位示图和空闲块链**3种。

**(1)空闲区表。**

将外存空间上的一个连续的未分配区域称为“空闲区”。操作系统为磁盘外存上的所有空闲区建立一张空闲表，每个表项对应一个空闲区，空闲表中包含序号、空闲区的第1块号、空闲块的块数和状态等信息，如表2-1所示。它适用于连续文件结构。

![image-20230210下午52610154](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230210%E4%B8%8B%E5%8D%8852610154.png)

**(2)位示图。**

这种方法是在外存上建立一张位示图(Bitmap),记录文件存储器的使用情况。每一位对应文件存储器上的一个物理块，取值0和1分别表示空闲和占用。

例如，某文件存储器上位示图的大小为 n，物理块依次编号为0,1,2，…。假如计算机系统中字长为
32位，那么在位示图中的第0个字（逻辑编号）对应文件存储器上的0,1,2，…，31号物理块：第1个字对应文件存储器上的32,33,34，…，63号物理块，依此类推，如图2-7所示。

![image-20230210下午52814087](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230210%E4%B8%8B%E5%8D%8852814087.png)

这种方法的主要特点是位示图的大小由磁盘空间的大小（物理块总数）决定，位示图的描述能力强，适合各种物理结构。

**(3)空闲块链。**

每个空闲物理块中有指向下一个空闲物理块的指针，所有空闲物理块构成一个链表，链表的头指针放在文件存储器的特定位置上（如管理块中），不需要磁盘分配表，节省空间。每次申请空闲物理块只需根据链表的头指针取出第1个空闲物理块，根据第一个空闲物理块的指针可找到第2个空闲物理块，依此类推。
**(4)成组链接法。**

UNIX系统采用该方法。例如，在实现时系统将空闲块分成若干组，每100个空闲块为一组，每组的第1个空闲块登记了下一组空闲块的物理盘块号和空闲块总数。
假如某个组的第1个空闲块号等于0，意味着该组是最后一组，无下一组空闲块。

**1)文件的共享**

文件共享是指不同用户进程使用同一文件，它不仅是不同用户完成同一任务所必须的功能，还可以节省大量的主存空间，减少由于文件复制而增加的访问外存次数。

文件共享有多种形式，采用文件名和文件说明分离的目录结构有利于实现文件共享。

常见的文件链接有**硬链接**和**符号链接**两种。

**(1)硬链接。**

文件的硬链接是指两个文件目录表目指向同一个索引结点的链接，该链接也称基于索引结点的链接。

换句话说，硬链接是指不同文件名与同一个文件实体的链接。文件硬链接不利于文件主删除它拥有的文件，因为文件主要删除它拥有的共享文件，必须首先删除(关闭)所有的硬链接，否则就会造成共享该文件的用户的目录表目指针悬空。

**(2)符号链接。**

符号链接建立新的文件或目录，并与原来文件或目录的路径名进行映射，当访问一个符号链接时，系统通过该映射找到原文件的路径，并对其进行访问。

采用符号链接可以跨越文件系统，甚至可以通过计算机网络连接到世界上任何地方的机器中的文件，此时只须提供该文件所在的地址以及在该机器中的文件路径。

> PS：各类网盘的实现：

**2)文件的保护**

文件系统对文件的保护常采用**存取控制**的方式进行。

所谓存取控制，就是规定不同的用户对文件的访问有不同的权限，以防止文件被未经文件主同意的用户访问。

**(1)存取控制矩阵。**

理论上，存取控制的方法可用存取控制矩阵实现，它是一个二维矩阵，一维列出计算机的全部用户，另一维列出系统中的全部文件，矩阵中的每个元素A表示第i个用户对第个文件的存取权限。

通常，存取权限有可读R、可写W、可执行X以及它们的组合，如表2-2所示。

![image-20230210下午54611031](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230210%E4%B8%8B%E5%8D%8854611031.png)

![image-20230210下午54637991](https://cdn.jsdelivr.net/gh/e9ab98e991ab/architecture@assets/assets/image-20230210%E4%B8%8B%E5%8D%8854637991.png)

**(2)存取控制表。**

存取控制矩阵由于太大往往无法实现。一个改进的办法是按用户对文件的访问权力的差别对用户进行分类，由于某一文件往往只与少数几个用户有关，所以这种分类方法可使存取控制表简化。

UNX系统就是使用了这种存取控制表方法，它把用户分成三类：**文件主、同组用户和其他用户**，每类用户的存取权限为可读、可写、可执行以及它们的组合。

**(3)用户权限表。**

改进存取控制矩阵的另一种方法是以用户或用户组为单位将用户可存取的文件集中起来存入表中，这称为用户权限表。表中的每个表目表示该用户对应文件的存取权限，这相当于存取控制矩阵一行的简化。
**(4)密码。**

在创建文件时，由用户提供一个密码，在文件存入磁盘时用该密码对文件的内容加密。在进行读取操作时，要对文件进行解密，只有知道密码的用户才能读取文件。

#### 2.3.5 网络协议

在计算机网络中要实现资源共享以及信息交换，必须实现不同系统中实体的通信。两个实体要想成功通信，它们必须具有相同的语言，在计算机网络中称为协议（或规程）。所谓协议，指的是网络中的计算机与计算机进行通信时，为了能够实现数据的正常发送与接收必须要遵循的一些事先约定好的规则（标准或约定），在这些规程中明确规定了通信时的数据格式、数据传送时序以及相应的控制信息和应答信号等内容。
常用的网络协议包括局域网协议(LAN)、广域网协议(WAN)、无线网协议和移动网协议。互联网使是TCP/IP协议簇。
